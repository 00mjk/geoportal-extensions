<!DOCTYPE html>
<html>
    <head>
        <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
        <meta charset="UTF-8">

        <!-- leaflet head common stuf -->
        <!-- Library Leaflet -->
        <link rel="stylesheet" href="../../node_modules/leaflet/dist/leaflet.css" />
        <!-- Leaflet Geoportal extension -->
        <link rel="stylesheet" href="../../dist/leaflet/GpPluginLeaflet-src.css" />
        <!-- requirejs -->
        <script src="../../node_modules/requirejs/require.js"></script>
        <script>
            /* global requirejs */
            requirejs.config({
                'paths': {
                    "leaflet" : "../../node_modules/leaflet/dist/leaflet-src",
                    "Gp"      : "../../dist/leaflet/GpPluginLeaflet-src"
                }
            });
        </script>

        <title>Sample Leaflet</title>
        <style>
          div#map {
            width: 100%;
            height: 500px;
          }
        </style>

    </head>
    <body>
        <h1>Extension Géoportail pour Leaflet (mode AMD)</h1>

        <h2>Ajout de tous les Widget</h2>
        <!-- map -->
        <div id="map"></div>

        <script type="text/javascript">
          var map;
          requirejs(["leaflet", "Gp"], function (L, Gp) {

            var createMap = function () {
              // Création de la map
              var layer = L.geoportalLayer.WMS({
                layer : "ORTHOIMAGERY.ORTHOPHOTOS"
              });

              var map  = L.map('map', {
                zoom : 2,
                center : L.latLng(48, 2)
              });

              layer.addTo(map);

              var iso = L.geoportalControl.Isocurve();
              map.addControl(iso);
              var layerSwitcher = L.geoportalControl.LayerSwitcher();
              map.addControl(layerSwitcher);
              var mp = L.geoportalControl.MousePosition();
              map.addControl(mp);
              var route = L.geoportalControl.Route();
              map.addControl(route);
              var reverse = L.geoportalControl.ReverseGeocode();
              map.addControl(reverse);
              var search = L.geoportalControl.SearchEngine();
              map.addControl(search);
              var measureProfil = L.geoportalControl.ElevationPath();
              map.addControl(measureProfil);
            };

            Gp.Services.getConfig({
              apiKey : "jhyvi0fgmnuxvfv0zjzorvdn",
              onSuccess : createMap
            });
          });
        </script>
    </body>
</html>
